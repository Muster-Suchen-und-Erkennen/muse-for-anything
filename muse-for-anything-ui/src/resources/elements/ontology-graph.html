<template data-maximized.bind="maximized & empty">
    <require from="./schema-form"></require>
    <require from="./validity-indicator"></require>
    <require from="./svg-icon.html"></require>
    <require from='./tree-node'></require>

    <template id="ontologyGraphTemplate">
        <svg>
            <style>
                svg {
                    display: block;
                    width: 100%;
                    height: 100%;
                    border-radius: 0.375rem;
                    background-color: var(--fill-color);
                    --line-color: black;
                    --line-highlight-color: #6d28d9;
                    --text-color: black;
                    --text-highlight-color: black;
                    --fill-color: white;
                    --fill-highlight-color: white;
                    --highlight-child-color: #fa7bef;
                    --highlight-parent-color: #ff00ea;
                    --taxonomy-color: #FABA6F;
                    --type-color: #bdbdbd;
                    --position-rect-color: #6c28d95d;
                }

                svg .zoom-group {
                    will-change: contents, transform;
                }

                .type-group {
                    fill: var(--type-color) !important;
                }

                .node.selected>.type-group {
                    fill: var(--highlight-parent-color) !important;
                    opacity: 1;
                }

                .node.selected>.taxonomy-group {
                    fill: var(--highlight-parent-color) !important;
                    opacity: 1;
                }

                .node.selected>.taxonomy-link-item {
                    fill: var(--highlight-child-color) !important;
                    opacity: 1;
                }
                
                .node.selected>.type-link-item {
                    fill: var(--highlight-child-color) !important;
                    opacity: 1;
                }
                
                .node.selected>.type-item {
                    fill: var(--highlight-child-color) !important;
                    opacity: 1;
                }
                
                .node.selected>.taxonomy-item {
                    fill: var(--highlight-child-color) !important;
                    opacity: 1;
                }

                .node.selected>ellipse {
                    fill: var(--highlight-parent-color) !important;
                    opacity: 1;
                }

                .node>rect {
                    fill: var(--fill-color);
                    stroke: var(--line-color);
                }

                .greyedout-node {
                    opacity: 0.1;
                }

                .invisible-node {
                    opacity: 0;
                }

                .node>ellipse {
                    fill: var(--taxonomy-color);
                    stroke: var(--line-color);
                }

                .type-link-item, .taxonomy-link-item {
                    stroke-dasharray: 5px;
                }

                .link-handle {
                    display: none;
                    visibility: hidden;
                }

                .title {
                    fill: var(--text-color);
                    font-size: initial;
                    text-overflow: ellipsis;
                    word-break: break-all;
                    border-bottom: double;
                }

                .titleDescription {
                    fill: var(--text-color);
                    font-size: small;
                    text-overflow: ellipsis;
                    word-break: break-all;
                    border-bottom: double;

                }

                .description {
                    fill: var(--text-color);
                    font-size: 6pt;
                    text-overflow: ellipsis;
                }

                .node.hovered:not(.deleted) .link-handle {
                    display: initial;
                }

                .node.hovered>rect {
                    fill: var(--fill-highlight-color);
                    stroke: var(--line-highlight-color);
                }

                .node.selected .title {
                    fill: var(--text-highlight-color);
                }

                .node.deleted {
                    opacity: 0.5;
                }

                .edge {
                    stroke: var(--line-color);
                    opacity: 0.5;
                }

                .edge.selected {
                    stroke: var(--line-color);
                    opacity: 1;
                    stroke-width: 5px;
                }

                .edge.highlight-edge {
                    stroke: var(--line-color);
                    opacity: 1;
                    stroke-width: 5px;
                }

                .edge-group .marker {
                    fill: var(--line-color);
                }

                .highlight-outgoing .edge {
                    stroke: var(--line-highlight-color);
                }

                .highlight-outgoing.edge-group .marker {
                    fill: var(--line-highlight-color);
                }

                .position-rect {
                    fill: var(--position-rect-color) !important;
                    border-style: none !important;
                }
            </style>
            <defs class="templates">
                <g transform="scale(0.1)" id="string">
                    <rect stroke-width="3" fill="#ffffff" x="2.5" y="2.5" width="95" height="95" id="svg_1" rx="10" stroke="#000000"/>
                    <rect fill="#BBBBBB" stroke="#C48157" x="265" y="23" width="0" height="1" id="svg_2"/>
                    <text transform="matrix(1 0 0 1 0 0)" font-style="normal" font-weight="normal" xml:space="preserve" text-anchor="start" font-family="sans-serif" font-size="51" id="svg_3" y="67.6246" x="6.20247" stroke-width="0" stroke="#000000" fill="#000000">Abc</text>
                </g>        
                <g transform="scale(0.1)" id="integer">
                    <rect stroke-width="3" fill="#ffffff" x="2.5" y="2.5" width="95" height="95" id="svg_1" rx="10" stroke="#000000"/>
                    <rect fill="#BBBBBB" stroke="#C48157" x="265" y="23" width="0" height="1" id="svg_2"/>
                    <text transform="matrix(1 0 0 1 0 0)" font-style="normal" font-weight="normal" xml:space="preserve" text-anchor="start" font-family="sans-serif" font-size="51" id="svg_3" y="67.6246" x="7.46028" stroke-width="0" stroke="#000000" fill="#000000">123</text>
                </g>
                <g transform="scale(0.1)" id="boolean">
                    <rect stroke="#000000" rx="10" id="svg_1" height="95" width="95" y="2.5" x="2.5" fill="#ffffff" stroke-width="3"/>
                    <rect id="svg_2" height="1" width="0" y="23" x="265" stroke="#C48157" fill="#BBBBBB"/>
                    <text transform="matrix(1 0 0 1 0 0)" style="cursor: move;" fill="#000000" stroke="#000000" stroke-width="0" x="12.22591" y="67.6246" id="svg_3" font-size="51" font-family="sans-serif" text-anchor="start" xml:space="preserve" font-weight="normal" font-style="normal">T|F</text>
                </g>
                <g transform="scale(0.1)" id="number">
                    <rect stroke-width="3" fill="#ffffff" x="2.5" y="2.5" width="95" height="95" id="svg_1" rx="10" stroke="#000000"/>
                    <rect fill="#BBBBBB" stroke="#C48157" x="265" y="23" width="0" height="1" id="svg_2"/>
                    <text transform="matrix(1 0 0 1 0 0)" style="cursor: move;" font-style="normal" font-weight="normal" xml:space="preserve" text-anchor="start" font-family="sans-serif" font-size="51" id="svg_3" y="67.50741" x="14.55404" stroke-width="0" stroke="#000000" fill="#000000">1.2</text>
                </g>
                <g transform="scale(0.1)" id="enum">
                    <rect stroke="#000000" rx="10" id="svg_1" height="95" width="95" y="2.93137" x="3.16667" fill="#ffffff" stroke-width="3"/>
                    <text transform="matrix(0.676311 0 0 0.69423 9.06328 19.6744)" stroke="#000000" xml:space="preserve" text-anchor="start" font-family="sans-serif" font-size="51" y="27.39974" x="34.5811" stroke-width="0" fill="#000000">Abc</text>
                    <text transform="matrix(0.676311 0 0 0.69423 9.06328 19.6744)" stroke="#000000" xml:space="preserve" text-anchor="start" font-family="sans-serif" font-size="51" y="67.39974" x="34.5811" stroke-width="0" fill="#000000">Abc</text>
                    <text transform="matrix(0.676311 0 0 0.69423 9.06328 19.6744)" stroke="#000000" xml:space="preserve" text-anchor="start" font-family="sans-serif" font-size="51" y="107.39974" x="34.5811" stroke-width="0" fill="#000000">Abc</text>
                    <ellipse ry="7.33333" rx="7.33333" cy="29.43137" cx="20.66667" stroke-width="0" stroke="#000000" fill="#000000"/>
                    <ellipse ry="7.33333" rx="7.33333" cy="55.43137" cx="20.66667" stroke-width="0" stroke="#000000" fill="#000000"/>
                    <ellipse ry="7.33333" rx="7.33333" cy="80.43137" cx="20.66667" stroke-width="0" stroke="#000000" fill="#000000"/>
                </g>


                <g id="taxonomy-link-item" data-template-type="node">
                    <rect width="120" height="60" x="-60" y="-30" rx="5" data-link-handles="edges"
                        class="taxonomy-link-item"></rect>
                    <text class="titleDescription" x="-45" y="-13" width="110" data-content="typedescription"></text>
                    <text class="title" data-content="title" x="-55" y="4" width="110"></text>
                    <text class="description" data-content="description" x="-55" y="2"
                        data-wrap-lines="110 70|110 110 70"></text>
                    <g transform="scale(0.1), translate(-570,-225)">
                        <rect stroke-width="3" fill="#ffffff" x="2.5" y="2.5" width="95" height="95" id="svg_1" rx="10" stroke="#000000"/>
                        <rect fill="#BBBBBB" stroke="#C48157" x="265" y="23" width="0" height="1" id="svg_2"/>
                        <ellipse ry="40" rx="40" id="svg_3" cy="50" cx="50" stroke-width="0" stroke="#FABA6F" fill="#FABA6F"/>
                    </g>
                </g>
                <g id="type-link-item" data-template-type="node">
                    <rect width="120" height="60" x="-60" y="-30" rx="5" data-link-handles="edges"
                        class="type-link-item"></rect>
                    <text class="titleDescription" x="-45" y="-13" width="110" data-content="typedescription"></text>
                    <text class="title" data-content="title" x="-55" y="4" width="110"></text>
                    <text class="description" data-content="description" x="-55" y="2"
                        data-wrap-lines="110 70|110 110 70"></text>
                    <g transform="scale(0.1), translate(-570,-225)">
                        <rect stroke-width="3" fill="#ffffff" x="2.5" y="2.5" width="95" height="95" id="svg_1" rx="10" stroke="#000000"/>
                        <rect fill="#BBBBBB" stroke="#C48157" x="265" y="23" width="0" height="1" id="svg_2"/>
                        <ellipse ry="40" rx="40" id="svg_3" cy="50" cx="50" stroke-width="0" stroke="#dddddd" fill="#dddddd"/>
                    </g>
                </g>
                <g id="type-item" data-template-type="node">
                    <rect width="120" height="60" x="-60" y="-30" rx="5" data-link-handles="edges" class="type-item"></rect>
                    <text class="titleDescription" x="-45" y="-13" width="110" data-content="typedescription"></text>
                    <text class="title" data-content="title" x="-55" y="4" width="110"></text>
                    <text class="description" data-content="description" x="-55" y="2"
                        data-wrap-lines="110 70|110 110 70"></text>
                    <text class="sort-key" data-content="sortKey" x="55" y="26" width="35"></text>
                    <use data-href="typedescriptionHref" x="-56" y="-23"/>
                </g>
                <g id="taxonomy-item" data-template-type="node">
                    <rect width="120" height="60" x="-60" y="-30" rx="5" data-link-handles="edges" class="taxonomy-item"></rect>
                    <text class="titleDescription" x="-55" y="-13" width="110" data-content="typedescription"></text>
                    <text class="title" data-content="title" x="-55" y="4" width="110"></text>
                    <text class="description" data-content="description" x="-55" y="2"
                        data-wrap-lines="110 70|110 110 70"></text>
                    <text class="sort-key" data-content="sortKey" x="55" y="26" width="35"></text>
                </g>
                <g id="default-marker" data-template-type="marker" data-line-attachement-point="6">
                    <circle cx="0" cy="0" r="6"></circle>
                </g>
                <g id="arrow" data-template-type="marker" data-line-attachement-point="-9 0">
                    <path d="M -9 -4 L 0 0 L -9 4 z" />
                </g>
            </defs>
            <g class="zoom-group">
                <!-- the zoom-groop is used for the pan and zoom transormations -->
                <g class="nodes"></g> <!-- the first group will be rendered below the following groups-->
                <g class="edges"></g>
            </g>
        </svg>
    </template>


    <template id="ontologyoverviewGraphTemplate">
        <svg>
            <style>
                svg {
                    display: block;
                    width: 100%;
                    height: 100%;
                    border-radius: 0.375rem;
                    background-color: var(--fill-color);
                    --line-color: black;
                    --line-highlight-color: #6d28d9;
                    --text-color: black;
                    --text-highlight-color: #6d28d9;
                    --fill-color: rgba(255, 255, 255, 0);
                    --fill-highlight-color: rgba(255, 255, 255, 0);
                }

                svg .zoom-group {
                    will-change: contents, transform;
                }

                .ghost {
                    opacity: 0.5 !important;
                }

                .taxonomy-group {
                    fill: rgb(221, 221, 221) !important;
                }

                .type-group {
                    fill: rgb(189, 189, 189) !important;
                }

                .position-rect {
                    fill: #6c28d95d !important;
                    border-style: none !important;
                }

                .invisible-rect {
                    fill: #ffffff00 !important;
                    stroke: none !important;
                }

                .node>rect {
                    fill: none;
                    stroke: black;
                }

                .node>ellipse {
                    fill: #FABA6F !important;
                    stroke: #FABA6F;
                }

                .edge {
                    stroke: black;
                }

                .edge-group .marker {
                    fill: none
                }

                .highlight-outgoing .edge {
                    stroke: none
                }

                .highlight-outgoing.edge-group .marker {
                    fill: none
                }
            </style>
            <defs class="templates">
                <g id="item" data-template-type="node">
                    <rect width="120" height="60" x="-60" y="-30" rx="5" data-link-handles="edges"></rect>
                </g>
            </defs>
            <g class="zoom-group">
                <!-- the zoom-groop is used for the pan and zoom transormations -->
                <g class="nodes"></g> <!-- the first group will be rendered below the following groups-->
                <g class="edges"></g>
            </g>
        </svg>
    </template>

    <div if.bind=" !isAllowedToShowGraph">
        <h1 t="loading">Loading</h1>
    </div>
    <template else>
        <div class=" maindiv menu-section card">
            <div class="item-filtersection px-1 py-1 border-gray-200 border-b scroll-area">
                <span class="section-title">
                    ${"ontology.filter-area" | t}
                </span>
                <div class="section-subpart">
                    <input class="border rounded-sm border-gray-800 focus:ring-4 w-full px-2 py-1" placeholder="search"
                        value.from-view="filter & throttle" aria-owns="'datalist-'+slug" autocapitalize="none"
                        value.bind="searchtext & debounce" type="text" autocomplete="off" aria-autocomplete="list" role="combobox"
                        id="'input-'+slug" blur.trigger="searchtextFocusLeft()">
                </div>
                <span class="section-title">
                    ${"ontology.visibleElements" | t}
                </span>
                <div class="section-subpart">
                    <div>
                        <label class="cb_control control--checkbox">
                            <input type="checkbox" checked.bind="showTaxonomies">
                            <span class="control__indicator"></span>
                        </label>
                        ${"ontology.taxonomies" | t}
                    </div>
                    <div>
                        <label class="cb_control control--checkbox">
                            <input type="checkbox" checked.bind="showTypes">
                            <span class="control__indicator"></span>
                        </label>
                        ${"ontology.types" | t}
                    </div>
                    <div if.bind="!isLoading">
                        <button class="button-outline px-2 items-center" click.delegate="showSelectedItems()"
                            title='${"ontology.showSelectedItems" | t}'>
                            ${"ontology.showSelectedItems" | t}
                        </button>
                    </div>
                </div>
                <span class="section-title">
                    ${"ontology.childsToShow" | t}
                </span>
                <div class="section-subpart">
                    <div>
                        <input class="border rounded-sm border-gray-800 focus:ring-4 w-full px-2 py-1"
                            placeholder="search" value.from-view="filter & throttle" aria-owns="'datalist-'+slug"
                            autocapitalize="none" value.bind="typeChildsToShow" type="number" autocomplete="off"
                            aria-autocomplete="list" role="combobox" id="'input-'+slug" min="0">
                    </div>
                </div>
                <div>
                    ${"ontology.itemsInGraph" | t} ${graph.nodeList.length}
                </div>
                <!--springLength
                <input class="border rounded-sm border-gray-800 focus:ring-4 w-full px-2 py-1" placeholder="search"
                    value.from-view="filter & throttle" aria-owns="'datalist-'+slug" autocapitalize="none"
                    value.bind="springLength" type="text" autocomplete="off" aria-autocomplete="list" role="combobox"
                    id="'input-'+slug">
                    springCoefficient
                <input class="border rounded-sm border-gray-800 focus:ring-4 w-full px-2 py-1" placeholder="search"
                value.from-view="filter & throttle" aria-owns="'datalist-'+slug" autocapitalize="none"
                value.bind="springCoefficient" type="text" autocomplete="off" aria-autocomplete="list" role="combobox"
                id="'input-'+slug">
                gravity
                <input class="border rounded-sm border-gray-800 focus:ring-4 w-full px-2 py-1" placeholder="search"
                    value.from-view="filter & throttle" aria-owns="'datalist-'+slug" autocapitalize="none"
                    value.bind="gravity" type="text" autocomplete="off" aria-autocomplete="list" role="combobox"
                    id="'input-'+slug">
                    dimensions
                <input class="border rounded-sm border-gray-800 focus:ring-4 w-full px-2 py-1" placeholder="search"
                value.from-view="filter & throttle" aria-owns="'datalist-'+slug" autocapitalize="none"
                value.bind="dimensions" type="text" autocomplete="off" aria-autocomplete="list" role="combobox"
                id="'input-'+slug">
                theta
                <input class="border rounded-sm border-gray-800 focus:ring-4 w-full px-2 py-1" placeholder="search"
                    value.from-view="filter & throttle" aria-owns="'datalist-'+slug" autocapitalize="none"
                    value.bind="theta" type="text" autocomplete="off" aria-autocomplete="list" role="combobox"
                    id="'input-'+slug">
                    dragCoefficient
                <input class="border rounded-sm border-gray-800 focus:ring-4 w-full px-2 py-1" placeholder="search"
                value.from-view="filter & throttle" aria-owns="'datalist-'+slug" autocapitalize="none"
                value.bind="dragCoefficient" type="text" autocomplete="off" aria-autocomplete="list" role="combobox"
                id="'input-'+slug">
                timeStep
                <input class="border rounded-sm border-gray-800 focus:ring-4 w-full px-2 py-1" placeholder="search"
                    value.from-view="filter & throttle" aria-owns="'datalist-'+slug" autocapitalize="none"
                    value.bind="timeStep" type="text" autocomplete="off" aria-autocomplete="list" role="combobox"
                    id="'input-'+slug">
                    positionDifference
                <input class="border rounded-sm border-gray-800 focus:ring-4 w-full px-2 py-1" placeholder="search"
                value.from-view="filter & throttle" aria-owns="'datalist-'+slug" autocapitalize="none"
                value.bind="positionDifference" type="text" autocomplete="off" aria-autocomplete="list" role="combobox"
                id="'input-'+slug">-->
            </div>
            <div class="item-treesection px-1 py-1 border-gray-200 border-b scroll-area">

                <span class="section-title">
                    ${"ontology.tree-view" | t}
                </span>
                <tree-node repeat.for="node of dataItems" current.bind="node"></tree-node>
            </div>
            <div class="item-overview">
                <network-graph class="graphoverview" classes="deleted" mode="display" zoom="automatic"
                    svg-template="#ontologyGraphTemplate">
                </network-graph>
            </div>
        </div>
        <network-graph id="graphexportsvg" class="maingraph menu-graph ml-2 card" classes="deleted" mode="layout" zoom="both"
            svg-template="#ontologyGraphTemplate">
        </network-graph>
        <div id="ontology-loading-indicator" class="menu-graph ml-2 card" if.bind="isLoading">
            ${"loading" | t}
            <spinner type="S8" size="100" color="default"></spinner>
        </div>
        <div class="menu-graph ml-2 card"  if.bind="!isLoading && !isRendered">
            <button class="button-outline px-2 items-center" click.delegate="renderGraph()"
                    title='${"ontology.renderGraph" | t}'>
                    ${"ontology.renderGraph" | t}
                </button></div>
        <div class="menu-graph mb-0 mt-auto ml-auto mr-0">
            <div if.bind="selectedNode != null" class="card bg-white px-3 py-2 items-center detailview">
                <p class="section-title">${"ontology.detailview-header" | t}</p>
                <p class="detailview-item">name: ${selectedNode.name}</p>
                <p class="detailview-item">id: ${selectedNode.id}</p>
                <p class="detailview-item">description: ${selectedNode.description}</p>
                <p class="detailview-item">type: ${selectedNode.itemType}</p>
                <p class="detailview-item">abstract: ${selectedNode.abstract}</p>
                <p class="detailview-item">implementations: t.b.d.</p>
                <p class="detailview-item">href: ${selectedNode.href}</p>
                <p class="detailview-item">children: ${selectedNode.children.length}</p>
            </div>
            <div class="buttons card bg-white px-3 py-2 items-center" style="width: fit-content;float: right;">
                <button class="button-flat px-2 items-center" click.delegate="toggleMenu()"
                    title='${"ontology.moveLeft" | t}'>
                    <svg-icon icon.bind="maximizeMenu ? 'arrow-right' : 'arrow-left'" size.bind="18"></svg-icon>
                </button>
                <div if.bind="maximizeMenu">
                    <div class="ontology-moveBackground">
                        <div class="ontology-move">

                            <button class="button-flat px-2 items-center" click.delegate="moveGraph('up')"
                                title='${"ontology.moveUp" | t}'>
                                <svg-icon icon.bind="'arrow-up'" size.bind="18"></svg-icon>
                            </button>
                        </div>
                        <div class="ontology-move">
                            <button class="button-flat px-2 items-center" click.delegate="moveGraph('left')"
                                title='${"ontology.moveLeft" | t}'>
                                <svg-icon icon.bind="'arrow-left'" size.bind="18"></svg-icon>
                            </button>
                            <button class="button-flat px-2 items-center" click.delegate="moveGraph('right')"
                                title='${"ontology.moveRight" | t}'>
                                <svg-icon icon.bind="'arrow-right'" size.bind="18"></svg-icon>

                            </button>

                        </div>
                        <div class="ontology-move">
                            <button class="button-flat px-2 items-center" click.delegate="moveGraph('down')"
                                title='${"ontology.moveDown" | t}'>
                                <svg-icon icon.bind="'arrow-down'" size.bind="18"></svg-icon>
                            </button>

                        </div>
                    </div>

                    <button class="button-flat px-2 items-center" click.delegate="zoomIn()"
                        title='${"ontology.zoomIn" | t}'>
                        <svg-icon icon.bind="'plus'" size.bind="18"></svg-icon>
                    </button>
                    <button class="button-flat px-2 items-center" click.delegate="zoomOut()"
                        title='${"ontology.zoomOut" | t}'>
                        <svg-icon icon.bind="'minus'" size.bind="18"></svg-icon>
                    </button>
                    <button class="button-flat px-2 items-center" click.delegate="resetLayout()"
                        title='${"ontology.resetLayout" | t}'>
                        <svg-icon icon.bind="'reset'" size.bind="18"></svg-icon>
                    </button>
                    <button class="button-flat px-2 items-center" click.delegate="toggleMaximize()"
                        title='${"ontology.toggleMaximize" | t}'>
                        <svg-icon icon.bind="maximized ? 'minimize' : 'maximize'" size.bind="18"></svg-icon>
                    </button>
                    <button class="button-flat px-2 items-center" click.delegate="downloadSVG()"
                        title='${"ontology.toggleMaximize" | t}'>
                        <svg-icon icon.bind="'download'" size.bind="18"></svg-icon>
                    </button>
                </div>
            </div>
        </div>

    </template>
</template>